# Collect Friends API

AI-Agentä½ç½®æƒ…å ±å…±æœ‰ã‚¢ãƒ—ãƒªã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIï¼ˆFirebase Functionsï¼‰

## ğŸ—ï¸ æ§‹æˆ

```
api/
â”œâ”€â”€ functions/                 # Firebase Functions
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts          # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ ai/               # AIé–¢é€£API
â”‚   â”‚   â”œâ”€â”€ users/            # ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£API
â”‚   â”‚   â”œâ”€â”€ events/           # ã‚¤ãƒ™ãƒ³ãƒˆé–¢é€£API
â”‚   â”‚   â”œâ”€â”€ stores/           # åº—èˆ—é–¢é€£API
â”‚   â”‚   â””â”€â”€ utils/            # å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ firebase.json             # Firebaseè¨­å®š
â”œâ”€â”€ .firebaserc               # Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
â””â”€â”€ README.md                 # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
cd functions
npm install
```

### 2. Firebaseè¨­å®š
```bash
# Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šï¼ˆ.firebasercã‚’ç·¨é›†ï¼‰
# your-project-id ã‚’å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDã«å¤‰æ›´ã—ã¦ãã ã•ã„
```

### 3. ãƒ“ãƒ«ãƒ‰
```bash
npm run build
```

## ğŸ› ï¸ é–‹ç™º

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼èµ·å‹•
cd functions
npm run serve

# åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰
npm run build:watch
```

### ãƒ†ã‚¹ãƒˆ
```bash
npm test
```

### ãƒªãƒ³ãƒˆ
```bash
npm run lint
npm run lint:fix
```

## ğŸ“¦ ãƒ‡ãƒ—ãƒ­ã‚¤

### å…¨ä½“ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
cd functions
npm run deploy
```

### ç‰¹å®šã®é–¢æ•°ã®ã¿ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
firebase deploy --only functions:helloWorld
```

## ğŸ”§ åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `npm run build` | TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ« |
| `npm run build:watch` | ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« |
| `npm run serve` | ãƒ­ãƒ¼ã‚«ãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼èµ·å‹• |
| `npm run deploy` | æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ |
| `npm run logs` | é–¢æ•°ã®ãƒ­ã‚°ã‚’è¡¨ç¤º |
| `npm test` | ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ |
| `npm run lint` | ESLintå®Ÿè¡Œ |

## ğŸŒ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### ãƒ†ã‚¹ãƒˆç”¨
- `GET /helloWorld` - APIå‹•ä½œç¢ºèª

### AIé–¢é€£ï¼ˆäºˆå®šï¼‰
- `POST /generateAIProposal` - AIææ¡ˆç”Ÿæˆ
- `POST /processAIMatching` - AIãƒãƒƒãƒãƒ³ã‚°å‡¦ç†

### ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£ï¼ˆäºˆå®šï¼‰
- `POST /updateLocationSharing` - ä½ç½®æƒ…å ±å…±æœ‰è¨­å®š
- `GET /getNearbyUsers` - è¿‘ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—

### ã‚¤ãƒ™ãƒ³ãƒˆé–¢é€£ï¼ˆäºˆå®šï¼‰
- `POST /createEvent` - ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆ
- `PUT /updateEvent` - ã‚¤ãƒ™ãƒ³ãƒˆæ›´æ–°

### åº—èˆ—é–¢é€£ï¼ˆäºˆå®šï¼‰
- `POST /updateStoreStatus` - åº—èˆ—çŠ¶æ³æ›´æ–°
- `GET /getReservationLinks` - äºˆç´„ãƒªãƒ³ã‚¯å–å¾—

## ğŸ”’ èªè¨¼

Firebase Authenticationã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã‚’è¡Œã„ã¾ã™ã€‚
å„APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™ã€‚

## ğŸ“Š ç›£è¦–ãƒ»ãƒ­ã‚°

```bash
# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°ã®ç¢ºèª
firebase functions:log

# ç‰¹å®šã®é–¢æ•°ã®ãƒ­ã‚°
firebase functions:log --only helloWorld
```

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

1. **Firebase CLIãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„**
   ```bash
   npm install -g firebase-tools
   firebase login
   ```

2. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDãŒè¨­å®šã•ã‚Œã¦ã„ãªã„**
   ```bash
   # .firebasercãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDã‚’è¨­å®š
   firebase use --add
   ```

3. **Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ä¸ä¸€è‡´**
   ```bash
   # Node.js 20ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨
   node --version
   ```

## ğŸ“ TODO

- [ ] AIææ¡ˆæ©Ÿèƒ½ã®å®Ÿè£…
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½ç½®æƒ…å ±ç®¡ç†æ©Ÿèƒ½
- [ ] ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆãƒ»ç®¡ç†æ©Ÿèƒ½
- [ ] åº—èˆ—é€£æºæ©Ÿèƒ½
- [ ] ãƒ†ã‚¹ãƒˆã®è¿½åŠ 
- [ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®è¨­å®š 